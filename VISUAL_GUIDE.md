# ğŸ¯ VISUAL GUIDE: SYSTEM FIX & AUTHENTICATION FLOW

## âŒ How It Was (BROKEN)

### Your New Organization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        COMPANY                                  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  DEPARTMENT: IT      â”‚  â”‚  DEPARTMENT: HR      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  (Manager: Ahmad)    â”‚  â”‚  (Manager: Test)     â”‚  â”‚  DEPT: â”‚â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚  â”‚  OPS   â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚        â”‚â”‚
â”‚  â”‚  â”‚BACKEND â”‚ â”‚FRONT-â”‚  â”‚  â”‚RECRUIT   â”‚  â”Œâ”€â”€â”€â”€â”â”‚  â”‚ â”Œâ”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚  â”‚Team    â”‚ â”‚END   â”‚  â”‚  â”‚Team      â”‚  â”‚PAY-â”‚  â”‚ â”‚CUSTâ”‚â”‚ â”‚â”‚
â”‚  â”‚  â”‚        â”‚ â”‚Team  â”‚  â”‚  â”‚          â”‚  â”‚ROLLâ”‚  â”‚ â”‚SUP-â”‚â”‚ â”‚â”‚
â”‚  â”‚  â”‚        â”‚ â”‚      â”‚  â”‚  â”‚          â”‚  â”‚    â”‚  â”‚ â”‚PORTâ”‚â”‚ â”‚â”‚
â”‚  â”‚  â”‚Lead:   â”‚ â”‚Lead: â”‚  â”‚  â”‚Lead:     â”‚  â”‚    â”‚  â”‚ â”‚    â”‚ â”‚â”‚
â”‚  â”‚  â”‚Ahmad   â”‚ â”‚Siti  â”‚  â”‚  â”‚Test      â”‚  â”‚Leadâ”‚  â”‚ â”‚    â”‚ â”‚â”‚
â”‚  â”‚  â”‚        â”‚ â”‚      â”‚  â”‚  â”‚          â”‚  â”‚Noneâ”‚  â”‚ â”‚    â”‚ â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â”‚ â””â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚  â”‚        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Database Relationship Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         DEPARTMENTS TABLE            â”‚
â”‚                                      â”‚
â”‚ PK: department_id                    â”‚
â”‚ â€¢ department_name (UNIQUE)           â”‚
â”‚ â€¢ department_code (UNIQUE)           â”‚
â”‚ â€¢ manager_id (FK â†’ Staff)            â”‚
â”‚ â€¢ location                           â”‚
â”‚ â€¢ status: active/inactive            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ 1 Department â†’ Many Teams
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           TEAMS TABLE                â”‚
â”‚                                      â”‚
â”‚ PK: team_id                          â”‚
â”‚ â€¢ team_name                          â”‚
â”‚ â€¢ team_code (UNIQUE)                 â”‚
â”‚ â€¢ department_id (FK) â”€â”€â”€â”€â”€â”          â”‚
â”‚ â€¢ team_lead_id (FK â†’ Staff)          â”‚
â”‚ â€¢ status: active/inactive            â”‚
â”‚ â€¢ UNIQUE(team_name,dept_id)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ 1 Team â†’ Many Staff
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          STAFF TABLE                 â”‚
â”‚                                      â”‚
â”‚ PK: staff_id                         â”‚
â”‚ â€¢ staff_name                         â”‚
â”‚ â€¢ staff_email (UNIQUE)               â”‚
â”‚ â€¢ staff_password                     â”‚
â”‚ â€¢ department_id (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚ â€¢ team_id (FK) â”€â”€â”€â”€â”€â”        â”‚       â”‚
â”‚                     â”‚        â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ 1 Staff â†’ Many Attendance Records
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ATTENDANCE TABLE                â”‚
â”‚                                      â”‚
â”‚ â€¢ staff_id (FK)                      â”‚
â”‚ â€¢ attendance_date                    â”‚
â”‚ â€¢ check_in_time                      â”‚
â”‚ â€¢ check_out_time                     â”‚
â”‚ â€¢ status: present/absent/late/leave  â”‚
â”‚ â€¢ remarks                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    REPORTS SECTION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ATTENDANCE_REPORTS TABLE           â”‚
â”‚                                      â”‚
â”‚ PK: report_id                        â”‚
â”‚ â€¢ admin_id (FK) â€“ who created        â”‚
â”‚ â€¢ report_name                        â”‚
â”‚ â€¢ report_type: dept/team/staff/sum   â”‚
â”‚ â€¢ department_id (FK, optional)       â”‚
â”‚ â€¢ team_id (FK, optional)             â”‚
â”‚ â€¢ staff_id (FK, optional)            â”‚
â”‚ â€¢ start_date, end_date               â”‚
â”‚ â€¢ Calculated fields:                 â”‚
â”‚   - present_days                     â”‚
â”‚   - absent_days                      â”‚
â”‚   - late_days                        â”‚
â”‚   - leave_days                       â”‚
â”‚   - attendance_percentage            â”‚
â”‚ â€¢ generated_at                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ 1 Report â†’ Many Details
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ATTENDANCE_REPORT_DETAILS TABLE      â”‚
â”‚                                      â”‚
â”‚ â€¢ report_id (FK) â€“ parent report     â”‚
â”‚ â€¢ staff_id (FK)                      â”‚
â”‚ â€¢ attendance_id (FK, optional)       â”‚
â”‚ â€¢ attendance_date                    â”‚
â”‚ â€¢ check_in_time, check_out_time      â”‚
â”‚ â€¢ status                             â”‚
â”‚ â€¢ duration_minutes                   â”‚
â”‚ â€¢ remarks                            â”‚
â”‚                                      â”‚
â”‚ Purpose: Snapshot of data when       â”‚
â”‚ report was generated                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagram

### Staff Attendance Recording

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Staff Login    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Click Check-In  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CREATE Attendance Record           â”‚
â”‚  â€¢ staff_id (from session)          â”‚
â”‚  â€¢ attendance_date (TODAY)          â”‚
â”‚  â€¢ check_in_time (NOW)              â”‚
â”‚  â€¢ status: 'present'                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Work Day...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Click Check-Out â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UPDATE Attendance Record           â”‚
â”‚  â€¢ check_out_time (NOW)             â”‚
â”‚  â€¢ Calculate duration               â”‚
â”‚  â€¢ Finalize status                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Attendance recorded for today      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Report Generation Process

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin Request Report       â”‚
â”‚  â€¢ Select type: DEPARTMENT  â”‚
â”‚  â€¢ Select: IT Department    â”‚
â”‚  â€¢ Start: 2025-11-01        â”‚
â”‚  â€¢ End: 2025-11-30          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Query Data                          â”‚
â”‚  1. Find IT Department               â”‚
â”‚  2. Get all teams in IT              â”‚
â”‚  3. Get all staff in IT teams        â”‚
â”‚  4. Get attendance records           â”‚
â”‚  5. Calculate statistics             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CREATE Report Record                â”‚
â”‚  â€¢ report_type: 'department'         â”‚
â”‚  â€¢ department_id: IT_ID              â”‚
â”‚  â€¢ Statistics: present, absent, etc. â”‚
â”‚  â€¢ generated_at: NOW()               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CREATE Report Details (per staff)   â”‚
â”‚  For each staff member:              â”‚
â”‚  â€¢ For each day in date range:       â”‚
â”‚    - Create detail record            â”‚
â”‚    - Copy attendance data            â”‚
â”‚    - Store in report_details table   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Report Completed & Stored           â”‚
â”‚  â€¢ Available for future reference    â”‚
â”‚  â€¢ Can be printed/exported           â”‚
â”‚  â€¢ Historical data preserved         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Query Flow Diagrams

### Query 1: Get All IT Department Staff

```
User Request: "Show IT department staff"
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Department::where('code'='IT')
â”‚           ->first()          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ Returns: IT Department record
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ $dept->staff()               â”‚
â”‚ (Eloquent Relationship)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ Uses: department_id FK
           â”‚ Queries: staff table
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Returns: Collection of Staff â”‚
â”‚ â€¢ Ahmad Hassan              â”‚
â”‚ â€¢ Siti Nurhaliza            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Query 2: Get Backend Team Members with Details

```
User Request: "Show Backend team members"
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Team::where('code'='IT-BACKEND')     â”‚
â”‚      ->with('staff.profile')         â”‚
â”‚      ->first()                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ 
           â–¼ Returns: Team record + Staff
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ $team->staff                         â”‚
â”‚ Contains: All Backend team members   â”‚
â”‚ Including: Staff profiles (eager)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Returns Collection:                  â”‚
â”‚ â€¢ Ahmad Hassan - Backend Developer   â”‚
â”‚ â€¢ Phone: 012-xxxx-xxxx               â”‚
â”‚ â€¢ Position: Senior Developer         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Query 3: Generate Department Report

```
User: Admin â†’ Click "Generate IT Report"
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Get Department: IT                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Get All Teams in IT                  â”‚
â”‚ â€¢ Backend                            â”‚
â”‚ â€¢ Frontend                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Get All Staff in Teams               â”‚
â”‚ â€¢ Ahmad (Backend)                    â”‚
â”‚ â€¢ Siti (Frontend)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Get Attendance (Nov 1-30)            â”‚
â”‚ â€¢ Query: attendance table            â”‚
â”‚ â€¢ Filter: staff_id IN (Ahmad, Siti) â”‚
â”‚ â€¢ Filter: date range                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Calculate Statistics                 â”‚
â”‚ â€¢ Present Days: 20                   â”‚
â”‚ â€¢ Absent Days: 0                     â”‚
â”‚ â€¢ Late Days: 2                       â”‚
â”‚ â€¢ Leave Days: 0                      â”‚
â”‚ â€¢ Percentage: 91%                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CREATE Report Record                 â”‚
â”‚ â€¢ Type: department                   â”‚
â”‚ â€¢ Statistics stored                  â”‚
â”‚ â€¢ Timestamp: now                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CREATE Report Details                â”‚
â”‚ For each staff member Ã— each day:    â”‚
â”‚ â€¢ Ahmad - Nov 1: present 09:00-17:00â”‚
â”‚ â€¢ Ahmad - Nov 2: absent              â”‚
â”‚ â€¢ Siti - Nov 1: present 09:00-17:00 â”‚
â”‚ â€¢ ... etc                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Report Complete & Stored          â”‚
â”‚ Report ID: 1                         â”‚
â”‚ 22 detail records created            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Use Case Scenarios

### Scenario 1: New Employee Joins Backend Team

```
Action: Add Ahmad to Backend Team

1. Create Staff Record
   â”œâ”€â”€ staff_id: auto
   â”œâ”€â”€ name: Ahmad Hassan
   â”œâ”€â”€ email: ahmad@utm.edu.my
   â”œâ”€â”€ department_id: 1 (IT)
   â””â”€â”€ team_id: 1 (Backend)

2. System automatically:
   â”œâ”€â”€ Links to IT Department
   â”œâ”€â”€ Links to Backend Team
   â”œâ”€â”€ Makes eligible for team reports
   â”œâ”€â”€ Enables attendance tracking
   â””â”€â”€ Shows in department views

Result: Ahmad appears in:
â”œâ”€â”€ IT Department staff list
â”œâ”€â”€ Backend Team member list
â”œâ”€â”€ Attendance tracking
â””â”€â”€ Department/Team reports
```

### Scenario 2: Department Manager Reviews Team Performance

```
Action: IT Manager â†’ View Backend Team Report

1. Query Flow:
   Department (IT)
   â””â”€â†’ Teams [Backend, Frontend]
       â””â”€â†’ Attendance (Nov 1-30)
           â”œâ”€â”€ Ahmad: 20 present, 2 late
           â””â”€â”€ 3 other Backend team members

2. System calculates:
   â”œâ”€â”€ Team presence rate: 87%
   â”œâ”€â”€ Days with all present: 15
   â”œâ”€â”€ Days with absences: 2
   â”œâ”€â”€ Trends: improving/declining

3. Report Generated:
   â”œâ”€â”€ Team-level statistics
   â”œâ”€â”€ Individual breakdowns
   â”œâ”€â”€ Comparison to other teams
   â”œâ”€â”€ Exportable PDF/Excel
```

### Scenario 3: HR Needs Organization-Wide Report

```
Action: Admin â†’ Generate Summary Report

1. Query across all departments:
   â”œâ”€â”€ IT Department
   â”‚  â”œâ”€â”€ Backend: 87% present
   â”‚  â””â”€â”€ Frontend: 92% present
   â”œâ”€â”€ HR Department
   â”‚  â”œâ”€â”€ Recruitment: 95% present
   â”‚  â””â”€â”€ Payroll: 89% present
   â””â”€â”€ Operations: 84% present

2. Organization Summary:
   â”œâ”€â”€ Total Staff: 3 (test data)
   â”œâ”€â”€ Overall Present: 89.3%
   â”œâ”€â”€ Best Department: HR (92%)
   â”œâ”€â”€ Needs Attention: Operations (84%)

3. Historical Comparison:
   â””â”€ Compare to previous month
```

---

## ğŸ”„ Relationship Paths

### Path 1: From Department to Attendance

```
Department
  â””â”€ .teams()
      â””â”€ .staff()
          â””â”€ .attendance()

Example:
$dept = Department::find(1); // IT
$attendance = $dept->teams()   // Get teams
                 ->get()
                 ->pluck('staff') // Get staff in each team
                 ->flatten()      // Flatten collection
                 ->pluck('attendance') // Get attendance
                 ->flatten();
```

### Path 2: From Team Lead to Team Members

```
Staff (as Team Lead)
  â””â”€ .teamsManaged()
      â””â”€ .staff()
          â””â”€ .attendance()

Example:
$lead = Staff::find(1); // Ahmad
$teamMembers = $lead->teamsManaged() // Get teams led
                      ->get()
                      ->pluck('staff')
                      ->flatten();
```

### Path 3: From Report to Individual Records

```
AttendanceReport
  â””â”€ .details()
      â””â”€ .staff()

Example:
$report = AttendanceReport::find(1);
$details = $report->details()
                  ->with('staff', 'attendance')
                  ->get();

foreach ($details as $detail) {
    echo $detail->staff->name . ": " . $detail->status;
}
```

---

## ğŸ“Š Report Types Visual

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     REPORT TYPES                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  1. STAFF REPORT (Individual)           â”‚
â”‚     â”œâ”€ Staff: Ahmad Hassan             â”‚
â”‚     â”œâ”€ Period: Nov 1-30                â”‚
â”‚     â”œâ”€ Present: 20 days                â”‚
â”‚     â”œâ”€ Absent: 0 days                  â”‚
â”‚     â””â”€ Percentage: 95%                 â”‚
â”‚                                        â”‚
â”‚  2. TEAM REPORT                        â”‚
â”‚     â”œâ”€ Team: Backend Development       â”‚
â”‚     â”œâ”€ Department: IT                  â”‚
â”‚     â”œâ”€ Members: 5                      â”‚
â”‚     â”œâ”€ Overall Present: 87%            â”‚
â”‚     â””â”€ Details per member shown        â”‚
â”‚                                        â”‚
â”‚  3. DEPARTMENT REPORT                  â”‚
â”‚     â”œâ”€ Department: IT                  â”‚
â”‚     â”œâ”€ Teams: 2 (Backend, Frontend)    â”‚
â”‚     â”œâ”€ Total Staff: 7                  â”‚
â”‚     â”œâ”€ Overall Present: 89%            â”‚
â”‚     â””â”€ Stats by team shown             â”‚
â”‚                                        â”‚
â”‚  4. SUMMARY REPORT                     â”‚
â”‚     â”œâ”€ Organization-wide               â”‚
â”‚     â”œâ”€ Total Staff: 20                 â”‚
â”‚     â”œâ”€ Departments: 3                  â”‚
â”‚     â”œâ”€ Overall Present: 87%            â”‚
â”‚     â””â”€ Trends & comparisons            â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ Dashboard Views

### Admin Dashboard View

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ADMIN DASHBOARD                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                â”‚
â”‚  Quick Stats                                  â”‚
â”‚  â”œâ”€ Total Staff: 20                          â”‚
â”‚  â”œâ”€ Present Today: 18 (90%)                  â”‚
â”‚  â”œâ”€ Absent: 2                                â”‚
â”‚  â””â”€ Late: 0                                  â”‚
â”‚                                              â”‚
â”‚  Department Overview                         â”‚
â”‚  â”œâ”€ IT [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘] 89%                      â”‚
â”‚  â”œâ”€ HR [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 92%                      â”‚
â”‚  â””â”€ OPS [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 84%                     â”‚
â”‚                                              â”‚
â”‚  Quick Actions                               â”‚
â”‚  â”œâ”€ [Generate Report]                        â”‚
â”‚  â”œâ”€ [Manage Departments]                     â”‚
â”‚  â”œâ”€ [Manage Teams]                           â”‚
â”‚  â””â”€ [View History]                           â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Summary of Visual Changes

| View | Before | After |
|------|--------|-------|
| Staff Organization | Flat list | Hierarchical (Deptâ†’Teamâ†’Staff) |
| Filtering | By individual only | By staff/team/dept |
| Reports | Staff reports only | Staff/Team/Dept/Summary reports |
| Management | Limited | Full department & team mgmt |
| Relationships | 1 layer | Multi-layer hierarchy |

---

**Version:** 2.0  
**Date:** November 20, 2025  
**Visual Guide Complete** âœ…
